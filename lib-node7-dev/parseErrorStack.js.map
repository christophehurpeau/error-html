{"version":3,"sources":["../src/parseErrorStack.js"],"names":["err","stack","parse","files","Map","map","line","fileName","file","startsWith","has","get","fileContent","toString","contents","set","e"],"mappings":";;;;;;AAAA;;AACA;;;;;;kBAEe,yBAACA,GAAD,EAAS;AACtB,MAAIC,QAAQ,qBAAWC,KAAX,CAAiBF,GAAjB,CAAZ;;AAEA,QAAMG,QAAQ,IAAIC,GAAJ,EAAd;;AAEA,SAAOH,MAAMI,GAAN,CAAWC,IAAD,IAAU;AACzB,UAAMC,WAAWD,KAAKC,QAAtB;AACA,QAAIC,IAAJ;;AAEA,QAAID,YAAYA,SAASE,UAAT,CAAoB,GAApB,CAAhB,EAA0C;AACxC,UAAIN,MAAMO,GAAN,CAAUH,QAAV,CAAJ,EAAyB;AACvBC,eAAOL,MAAMQ,GAAN,CAAUJ,QAAV,CAAP;AACD,OAFD;AAKEC;AACA,YAAI;AACF,gBAAMI,cAAc,sBAAaL,QAAb,EAAuBM,QAAvB,EAApB;AACAL,eAAKD,QAAL,GAAgBA,QAAhB;AACAC,eAAKM,QAAL,GAAgBF,WAAhB;AACAT,gBAAMY,GAAN,CAAUR,QAAV,EAAoBC,IAApB;AACD,SALD,CAKE,OAAOQ,CAAP,EAAU;AACVb,gBAAMY,GAAN,CAAUR,QAAV,EAAoBC,OAAO,KAA3B;AACD;AAbH;AAeD;;AAEDF,SAAKE,IAAL,GAAYA,IAAZ;AACA,WAAOF,IAAP;AACD,GAxBM,CAAP;AAyBD,C","file":"parseErrorStack.js","sourcesContent":["import { readFileSync } from 'fs';\nimport stackTrace from 'stack-trace';\n\nexport default (err) => {\n  let stack = stackTrace.parse(err);\n\n  const files = new Map();\n\n  return stack.map((line) => {\n    const fileName = line.fileName;\n    let file;\n\n    if (fileName && fileName.startsWith('/')) {\n      if (files.has(fileName)) {\n        file = files.get(fileName);\n      } else if (BROWSER) {\n        files.set(fileName, file = false);\n      } else {\n        file = {};\n        try {\n          const fileContent = readFileSync(fileName).toString();\n          file.fileName = fileName;\n          file.contents = fileContent;\n          files.set(fileName, file);\n        } catch (e) {\n          files.set(fileName, file = false);\n        }\n      }\n    }\n\n    line.file = file;\n    return line;\n  });\n};\n"]}